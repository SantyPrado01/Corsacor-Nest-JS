<app-nabvar></app-nabvar>
  <h2>Perfil Empresa</h2>
  <div class="line"></div>
<div class="container">
  <div class="sidebar">
    <ul class="sidebar-menu">
      <li (click)="mostrarSeccion('datosEmpresa')" [class.active]="seccionActual === 'datosEmpresa'">Datos Empresa</li>
      <li (click)="mostrarSeccion('ordenesTrabajo')" [class.active]="seccionActual === 'ordenesTrabajo'">Ordenes de Trabajo</li>
      <li (click)="mostrarSeccion('facturas')" [class.active]="seccionActual === 'facturas'">Facturas</li>
    </ul>
  </div>
  <div class="form-container">
    <div *ngIf="seccionActual === 'datosEmpresa'">
      <form (ngSubmit)="actualizarEmpresa()" class="form-container">
        <div class="form-row">
          <div class="form-group">
            <label for="nombreEmpresa">Nombre de la Empresa:</label>
            <input type="text" id="nombreEmpresa" [(ngModel)]="servicio.nombre" name="nombreEmpresa" class="form-control" placeholder="Ingrese el nombre" required />
          </div>

          <div class="form-group">
            <label for="cuitEmpresa">CUIT:</label>
            <input type="number" id="cuitEmpresa" [(ngModel)]="servicio.cuit" name="cuitEmpresa" class="form-control" placeholder="Ingrese el CUIT" required />
          </div>

          <div class="form-group">
            <label for="categoriaEmpresa">Categoría de Empresa:</label>
            <select id="categoriaEmpresa" [(ngModel)]="servicio.categoria" name="categoriaEmpresa" class="form-control" required>
              <option value="" disabled selected>Seleccione una categoría</option>
              <option *ngFor="let categoria of categorias" [value]="categoria.categoriaServicioId">
                {{ categoria.nombre }}
              </option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="direccionEmpresa">Dirección:</label>
            <input type="text" id="direccionEmpresa" [(ngModel)]="servicio.direccion" name="direccionEmpresa" class="form-control" placeholder="Ingrese la dirección" required />
          </div>

          <div class="form-group">
            <label for="telefonoEmpresa">Teléfono:</label>
            <input type="tel" id="telefonoEmpresa" [(ngModel)]="servicio.telefono" name="telefonoEmpresa" class="form-control" placeholder="Ingrese el teléfono" required />
          </div>

          <div class="form-group autocomplete-group">
            <label for="ciudadEmpresa">Ciudad:</label>
            <input
              type="text"
              id="ciudadEmpresa"
              [(ngModel)]="ciudadNombre"
              name="ciudadNombre"
              class="form-control"
              placeholder="Ingrese la ciudad"
              (input)="buscarCiudad($event)"
              (change)="seleccionarCiudad($event)"
              list="ciudadesList"
              required
            />
            <datalist id="ciudadesList">
              <option *ngFor="let ciudad of ciudades" [value]="ciudad.nombre"></option>
            </datalist>
          </div>
        </div>

        <div class="form-row-full-width">
          <div class="form-group-full-width">
            <label for="descripcionEmpresa">Descripción:</label>
            <textarea id="descripcionEmpresa" [(ngModel)]="servicio.descripcion" name="descripcionEmpresa" class="form-control" rows="3" placeholder="Ingrese una descripción"></textarea>
          </div>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-save">Guardar Empresa</button>
          <button type="button" class="btn btn-cancel" (click)="cancelar()">Cancelar</button>
        </div>
      </form>
    </div>

    <div *ngIf="seccionActual === 'ordenesTrabajo'">
      <div class="form-row">
      
        <div class="form-group">
          <label for="empresaInput">Buscar por Empleado:</label>
          <input id="empresaInput" type="text" class="form-control" [(ngModel)]="filtroEmpleado" (ngModelChange)="filtrarOrdenes()" placeholder="Nombre del Empleado"/>
        </div>
    
        <div class="form-group">
          <label for="mesSelect">Mes:</label>
          <select id="mesSelect" class="form-control" [(ngModel)]="mesSeleccionado" (ngModelChange)="filtrarOrdenes()" >
            <option value="" disabled selected>Seleccionar Mes</option>
            <option *ngFor="let mes of meses" [value]="mes">{{ mes }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="anioSelect">Año:</label>
          <select id="anioSelect" class="form-control" [(ngModel)]="anioSeleccionado" (ngModelChange)="filtrarOrdenes()" >
            <option value="" disabled selected>Seleccionar Año</option>
            <option *ngFor="let anio of anios" [value]="anio">{{ anio }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="estadoSelect">Estado:</label>
          <select id="estadoSelect" class="form-control" [(ngModel)]="estadoSeleccionado" (ngModelChange)="filtrarOrdenes()" >
            <option value="" disabled selected>Seleccionar Estado</option>
            <option [ngValue]="true">Completado</option>
            <option [ngValue]="false">En Curso</option>
          </select>
        </div>
      </div>
    
      <div class="orden-trabajo-container">
        <h3>Listado de Órdenes de Trabajo</h3>
        <div class="orden-card-container">
          <div *ngFor="let orden of ordenesFiltradas" class="orden-card">
            <div class="orden-card-header">
              <h4>Orden N° {{ orden.Id }}</h4>
              <span *ngIf="orden.completado" class="status completed">Completada</span>
              <span *ngIf="!orden.completado" class="status pending">En Curso</span>
            </div>
    
            <div class="orden-card-body">
              <p><strong>Empleado:</strong>{{ orden.empleadoAsignado.apellido }}, {{ orden.empleadoAsignado.nombre }}</p>
              <p><strong>Días:</strong> {{ obtenerDias(orden.necesidadHoraria) }}</p>
              <p><strong>Horas Proyectadas:</strong> {{ orden.horasProyectadas }} horas</p>
              <p><strong>Horas Reales:</strong> {{ orden.horasReales }} horas</p>
            </div>
    
            <div class="orden-card-footer">
              <button>Ver detalles</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
